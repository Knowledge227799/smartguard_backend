<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <title>SmartGuard Domain Report</title>
    <style>
        body {
            font-family: "Segoe UI", sans-serif;
            margin: 40px;
            color: #333;
            font-size: 14px;
            line-height: 1.6;
        }

        h1,
        h2 {
            color: #222;
            margin-bottom: 10px;
            border-bottom: 2px solid #ccc;
            padding-bottom: 4px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 30px;
        }

        th,
        td {
            text-align: left;
            padding: 10px;
            vertical-align: top;
            border-bottom: 1px solid #ddd;
        }

        th {
            width: 220px;
            background-color: #f4f4f4;
            font-weight: 600;
            color: #555;
        }

        ul {
            margin: 4px 0;
            padding-left: 20px;
        }

        li {
            margin-bottom: 3px;
        }

        .risk-low {
            color: green;
        }

        .risk-medium {
            color: #e6a800;
        }

        .risk-high {
            color: red;
            font-weight: bold;
        }

        .footer {
            text-align: center;
            font-size: 0.75rem;
            margin-top: 60px;
            color: #999;
            page-break-before: always;
        }
    </style>
</head>

<body>
    <h1 style="text-align: center;">SmartGuard Domain Analysis Report</h1>

    <h2>1. Domain Summary</h2>
    <table>
        <tr>
            <th>Domain</th>
            <td>{{ domain }}</td>
        </tr>
        <tr>
            <th>TLD</th>
            <td>{{ tld or "N/A" }}</td>
        </tr>
        <tr>
            <th>Is IP Address</th>
            <td>{{ "Yes" if is_ip else "No" }}</td>
        </tr>
        <tr>
            <th>Uses HTTPS</th>
            <td>{{ "Yes" if has_https else "No" }}</td>
        </tr>
        <tr>
            <th>Shortened URL</th>
            <td>{{ "Yes" if is_shortened else "No" }}</td>
        </tr>
        <tr>
            <th>Typosquatting Score</th>
            <td>{{ typosquatting_score or "0.0" }}</td>
        </tr>
        <tr>
            <th>Domain Age (days)</th>
            <td>{{ domain_age_days or "Unknown" }}</td>
        </tr>
        <tr>
            <th>Phishing Detected (ML)</th>
            <td>{{ "No" if safe else "Yes" }}</td>
        </tr>
        <tr>
            <th>Confidence</th>
            <td>{{ "%.2f%%" % (confidence * 100) }}</td>
        </tr>
        <tr>
            <th>Risk Score</th>
            <td
                class="{{ 'risk-low' if risk_level == 'low' else ('risk-medium' if risk_level == 'medium' else 'risk-high') }}">
                {{ risk_score }} ({{ risk_level | upper }})
            </td>
        </tr>
        {% if warning %}
        <tr>
            <th>Warning</th>
            <td>{{ warning }}</td>
        </tr>
        {% endif %}
    </table>

    <h2>2. Feature Summary</h2>
    <table>
        <tr>
            <th>Domain Length</th>
            <td>{{ features_used.domain_length }}</td>
        </tr>
        <tr>
            <th>Digits in Domain</th>
            <td>{{ features_used.num_digits }}</td>
        </tr>
        <tr>
            <th>Hyphens in Domain</th>
            <td>{{ features_used.num_hyphens }}</td>
        </tr>
        <tr>
            <th>HTTPS Present</th>
            <td>{{ "Yes" if features_used.has_https else "No" }}</td>
        </tr>
        <tr>
            <th>Subdomains</th>
            <td>{{ features_used.num_subdomains }}</td>
        </tr>
        <tr>
            <th>TLD Code</th>
            <td>{{ features_used.tld }}</td>
        </tr>
        <tr>
            <th>Suspicious TLD</th>
            <td>{{ "Yes" if features_used.is_suspicious_tld else "No" }}</td>
        </tr>
    </table>

    <h2>3. WHOIS Information</h2>
    <table>
        <tr>
            <th>Domain Name</th>
            <td>{{ whois.domain_name or "N/A" }}</td>
        </tr>
        <tr>
            <th>Registrar</th>
            <td>{{ whois.registrar or "N/A" }}</td>
        </tr>
        <tr>
            <th>Owner</th>
            <td>{{ whois.owner or "N/A" }}</td>
        </tr>
        <tr>
            <th>Organization</th>
            <td>{{ whois.organization or "N/A" }}</td>
        </tr>
        <tr>
            <th>Creation Date</th>
            <td>{{ whois.creation_date or "N/A" }}</td>
        </tr>
        <tr>
            <th>Expiry Date</th>
            <td>{{ whois.expiry_date or "N/A" }}</td>
        </tr>
        <tr>
            <th>Name Servers</th>
            <td>
                {% if whois.name_servers %}
                <ul>{% for ns in whois.name_servers %}<li>{{ ns }}</li>{% endfor %}</ul>
                {% else %}N/A{% endif %}
            </td>
        </tr>
        <tr>
            <th>Status</th>
            <td>
                {% if whois.status %}
                {% if whois.status is string %}
                {{ whois.status }}
                {% elif whois.status is iterable %}
                <ul>{% for s in whois.status %}<li>{{ s }}</li>{% endfor %}</ul>
                {% else %}
                {{ whois.status }}
                {% endif %}
                {% else %}
                N/A
                {% endif %}
            </td>
        </tr>
        <tr>
            <th>Emails</th>
            <td>
                {% if whois.emails %}
                {% if whois.emails is string %}
                {{ whois.emails }}
                {% else %}
                <ul>{% for email in whois.emails %}<li>{{ email }}</li>{% endfor %}</ul>
                {% endif %}
                {% else %}N/A{% endif %}
            </td>
        </tr>
        <tr>
            <th>WHOIS Error</th>
            <td>{{ whois.error or "None" }}</td>
        </tr>
    </table>

    <p class="footer">Report generated by SmartGuard on {{ date }}</p>
</body>

</html>